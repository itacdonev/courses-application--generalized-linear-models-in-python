---
title: Insert title here
key: 65f818a323555163f8ee44d12e7c3566

---
## Why Generalized Linear Models?

```yaml
type: "TitleSlide"
key: "d7295e1d38"
```

`@lower_third`

name: Ita Cirovic Donev
title: 


`@script`
Hi, my name is Ita and I welcome you to this course on Generalized Linear Models in Python. Generalized linear models or GLMs for short provide a versatile framework for statistical modeling of data and are used often to solve real world problems. We will examine several of such problems in lessons to come. So stay tuned!


---
## Introduction

```yaml
type: "FullSlide"
key: "284a1d46df"
```

`@part1`
- Motivation for GLM {{1}}
- Building blocks of GLM {{2}}
- Build knowledge on practical examples using Poisson and logistic regression{{3}}

Objectives: {{4}}
- understand how GLM works {{5}}
- formulate and implement a GLM in Python {{6}} 
- interpret the model results {{7}}
- make prediction {{8}}


`@script`
We will begin the course by motivating the need for GLMs with the review of linear models and how we arrive at the generalized term in the GLM name. By the end of the course you will understand the building blocks of GLMs and how to implement them in Python, identify and analyze different data distributions, define and fit the model and interpret the output and finally, learn how to use fitted model to make predictions on new data.


---
## Review of Linear Models

```yaml
type: "TwoColumns"
key: "a98b8ad71d"
```

`@part1`
**Simple linear model**  {{0}}

$\normalsize{y = \beta_0 + \beta_1x_1 + \epsilon}$ {{0}}


**General linear model**  
(classical GLM)  {{1}}

$\normalsize{y = \beta_0 + \beta_1x_1 + ... + \beta_px_p + \epsilon}$ {{1}}

&nbsp;

Goal   {{2}}

$\normalsize{\mu = E[y|X] = \beta_0 + \beta_1x_1 + ... + \beta_px_p}$ {{2}}


`@part2`
Assumptions {{3}}
- linear in parameters; $E[y|X]=X\beta$ {{4}}
- errors: independent and normally distributed {{5}}
- constant variance {{6}}


What if ... ?   {{7}}
- the response is not continuous, but for example binary or count {{8}}
- variance of $y$ depends on the mean {{9}}


`@script`
To answer these questions, let's consider an example.


---
## Motivating Example - Data

```yaml
type: "FullSlide"
key: "55ff39cc92"
```

`@part1`
- Contamination of ground water with arsenic in Bangladesh
- 3020 observations (`1`: 1737, `0`: 1283) 
- model the decision on switching wells 

|Variables|Name|Description|
|:-|-|:-|
|Response|`switch`|1 if change of water source occurred; 0 otherwise|
|Explanatory|`arsenic`| The level of arsenic contamination in the well|
|Explanatory|`distance`| Distance to the closest known safe well|
|Explanatory|`education`|Years of education of the head of the household|


`@script`
- model the decision on switching wells, i.e. changing the


---
## Motivating example - the LM model

```yaml
type: "FullSlide"
key: "c497ddb85d"
```

`@part1`
```python
formula = 'switch ~ arsenic' 
``` {{1}}
```python
family = sm.families.Gaussian() 
``` {{3}}
```py
smf.glm(formula = formula, data = wells, family = family).fit()
``` {{4}}

![](http://assets.datacamp.com/production/repositories/3864/datasets/3ef6d3d112099677e1ca9fb09c9961cf2b1de7c9/Ch1_L1_Scatter_plot_arsenic.png)
{{2}}


`@script`



---
## Motivating example - the LM model

```yaml
type: "FullSlide"
key: "551e61472a"
disable_transition: true
```

`@part1`
```python
formula = 'switch ~ arsenic' 

family = sm.families.Gaussian() 

smf.glm(formula = formula, data = wells, family = family).fit()
```
![](http://assets.datacamp.com/production/repositories/3864/datasets/de114467b003fea04daa83aae23dce73b4d1bade/Ch1_L1_Scatter_plot_LM_arsenic_basic.png)


`@script`



---
## Motivating example - the LM model

```yaml
type: "FullSlide"
key: "9a7702ce6a"
disable_transition: true
```

`@part1`
```python
formula = 'switch ~ arsenic'

family = sm.families.Gaussian()

smf.glm(formula = formula, data = wells, family = family).fit()
``` 

![](http://assets.datacamp.com/production/repositories/3864/datasets/4ee031be36efd84878e82ca015eaf4d2160217ce/Ch1_L1_Scatter_plot_LM_arsenic.png)


`@script`



---
## Motivating example - the LM model

```yaml
type: "FullSlide"
key: "4cc5f907b4"
```

`@part1`
Conclusion: 
- normality violation: distribution  of $y$ is highly skewed when $p$ is close to 0 or 1 
- variance of $y$ depends on the mean value 
- violates restriction that $0 \le p \le 1$


`@script`



---
## Motivating example - A correct model (GLM)

```yaml
type: "FullSlide"
key: "387f3c5591"
```

`@part1`
```python
formula = 'switch ~ arsenic' 
``` {{1}}
```python
family = sm.families.Binomial() 
``` {{2}}
```py
smf.glm(formula = formula, data = wells, family = family).fit()
``` {{3}}

![](http://assets.datacamp.com/production/repositories/3864/datasets/3ef6d3d112099677e1ca9fb09c9961cf2b1de7c9/Ch1_L1_Scatter_plot_arsenic.png)
{{1}}


`@script`



---
## Motivating example - A correct model (GLM)

```yaml
type: "FullSlide"
key: "33c3df5544"
disable_transition: true
```

`@part1`
```python
formula = 'switch ~ arsenic' 

family = sm.families.Binomial() 

smf.glm(formula = formula, data = wells, family = family).fit()
``` 

![](http://assets.datacamp.com/production/repositories/3864/datasets/846288f2ee857a9bdf6681e001d701ce6981487b/Ch1_L1_Scatter_plot_GLM_arsenic.png)


`@script`



---
## Motivating example - A correct model (GLM)

```yaml
type: "FullSlide"
key: "392587dd68"
```

`@part1`
Conclusion:
- Correct model formulation {{1}}
- predictions are bounded by (0,1) {{2}}
- take into account how the response variable is measured {{3}}


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "f3ef0a4fe2"
```

`@part1`
- explanatory variables: categorical, continuous {{1}}
- responses are independent random variables {{2}}

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
{{3}}


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "0aa0fd5995"
disable_transition: true
```

`@part1`
- explanatory variables: categorical, continuous
- responses are independent random variables

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
| Binary      	| `True, False`                         	    | Logistic regression              	|


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "a876d49eb8"
disable_transition: true
```

`@part1`
- explanatory variables: categorical, continuous
- responses are independent random variables

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
| Binary      	| `True, False`                         	    | Logistic regression              	|
| Counts      	| `5, 7, 12, 4` votes                                 | Poisson regression               	|


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "b139b03d68"
disable_transition: true
```

`@part1`
- explanatory variables: categorical, continuous
- responses are independent random variables

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
| Binary      	| `True, False`                         	    | Logistic regression              	|
| Counts      	| `5, 7, 12, 4` votes                                 | Poisson regression               	|
| Nominal 	    | `red, green, blue` 	                        | Multinominal logistic regression 	|


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "54df08102b"
disable_transition: true
```

`@part1`
- explanatory variables: categorical, continuous
- responses are independent random variables

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
| Binary      	| `True, False`                         	    | Logistic regression              	|
| Counts      	| `5, 7, 12, 4` votes                                 | Poisson regression               	|
| Nominal 	    | `red, green, blue` 	                        | Multinominal logistic regression 	|
| Ordinal     	| `[1-10),[10-20),[>20)`                        | Ordinal logistic regression      	|


`@script`



---
## Types of Response Variables

```yaml
type: "FullSlide"
key: "ea23bd526b"
disable_transition: true
```

`@part1`
- explanatory variables: categorical, continuous
- responses are independent random variables

| Response    	| Example                                     	| Method                           	|
|-------------	|:-------------------------------------------:	|:---------------------------------:|
| Continuous  	| `sale price`                                  | Multiple regression             	| 
| $\color{blue}{\text{Binary}}$      	| `True, False`          | $\color{blue}{\text{Logistic Regression}}$              	|
| $\color{blue}{\text{Counts}}$      	| `5, 7, 12, 4` votes          | $\color{blue}{\text{Poisson regression}}$               	|
| Nominal 	    | `red, green, blue` 	                        | Multinominal logistic regression 	|
| Ordinal     	| `[1-10),[10-20),[>20)`                        | Ordinal logistic regression      	|


`@script`
Now that we have seen how the GLMs apply in situations where the main assumptions of the linear model are not satisfied, let's examine further in which situations we can apply the GLMs.


---
## Let's practice!

```yaml
type: "FinalSlide"
key: "72f692d178"
```

`@script`


